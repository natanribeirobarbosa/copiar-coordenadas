document.addEventListener("DOMContentLoaded", function () {
    let map = L.map('map').setView([-23.5505, -46.6333], 13); // S√£o Paulo como ponto inicial

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    let selectedMarker = null; // Vari√°vel para armazenar o marcador

    // Evento de clique no mapa
    map.on('click', function (e) {
        let { lat, lng } = e.latlng;

        // Remove o marcador anterior, se existir
        if (selectedMarker) {
            map.removeLayer(selectedMarker);
        }

        // Adiciona um novo marcador na posi√ß√£o clicada
        selectedMarker = L.marker([lat, lng]).addTo(map)
            .bindPopup(`üìç Local Selecionado<br>Lat: ${lat.toFixed(5)}<br>Lng: ${lng.toFixed(5)}`)
            .openPopup();

        // Atualiza o texto com as coordenadas
        document.getElementById("coordinates").innerText = `Coordenadas: ${lat.toFixed(5)}, ${lng.toFixed(5)}`;

        // Salva as coordenadas na vari√°vel global
        window.selectedCoordinates = `${lat.toFixed(5)}, ${lng.toFixed(5)}`;
    });

    // Evento para copiar coordenadas ao clicar no bot√£o
    document.getElementById("copyButton").addEventListener("click", function () {
        if (window.selectedCoordinates) {
            navigator.clipboard.writeText(window.selectedCoordinates)
                .then(() => alert("üìã Coordenadas copiadas com sucesso!"))
                .catch(() => alert("‚ùå Erro ao copiar as coordenadas."));
        } else {
            alert("‚ùó Selecione um local no mapa primeiro.");
        }
    });
});
